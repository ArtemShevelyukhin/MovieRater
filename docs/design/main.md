# Техническое задание (ТЗ) для разработки веб-приложения "MovieRater"

## 1. Общая информация

**Название проекта:** MovieRater  
**Описание:** Веб-приложение для совместной оценки фильмов с друзьями. Пользователи могут ставить оценки фильмам, отслеживать свои и чужие оценки, а также просматривать статистику, такую как количество оценок, средние баллы по фильмам, пользователям и группам. Приложение ориентировано на социальное взаимодействие в небольших группах (друзья, семьи), с фокусом на простоту использования для MVP.  
**Цели:**  
- Облегчить совместный просмотр и обсуждение фильмов.  
- Собрать и визуализировать статистику по оценкам для повышения вовлеченности.  
- Обеспечить базовую безопасность и масштабируемость для роста пользователей.  
**Целевая аудитория:** Пользователи от 18 лет, интересующиеся кино, желающие делиться мнениями с друзьями (до 100 активных пользователей на старте).  
**Объем MVP:** Минимально жизнеспособный продукт включает регистрацию, добавление фильмов, оценки и базовую статистику. Дополнительные фичи (интеграции с API фильмов) отложить на будущие итерации.  
**Заказчик/Владелец:** [Укажите имя или роль, если известно].  
**Разработчик:** Senior-разработчик на Python.  
**Версия ТЗ:** 1.0 (от 19.12.2025).

## 2. Функциональные требования (MVP)

Функциональные требования описаны в формате user stories из Agile. Каждая история включает acceptance criteria для ясности.

1. **As a new user, I want to register an account using Telegram account.**  
   Acceptance criteria:  
   - возможность зарегистрироваться в приложении с помощью аккакунта в телеграм 

1. **As a user, I want to create a Room**  
   Acceptance criteria:  
   - возможность создать Комнату

1. **As a user, I want to enter a Room**  
   Acceptance criteria:  
   - возможность подключиться к Комнате
   
1. **As a user, I want to add a movie to the Room queue**  
   Acceptance criteria:  
   - фильм добавляется через ссылку на Кинопоиск. Из Кинопоиска подтягивается картинка, название, год выхода.

1. **As a user, I want to rate a movie so that my friends can see my opinion.**  
   Acceptance criteria:  
   - Шкала оценок от 1 до 10 с шагом в 0,5 и округлением оценки с точностью 1 знак после запятой. 
   - Оценка привязана к пользователю и фильму.  
   - Возможность обновить свою оценку.

1. **As a user, I want to invite friends to a Room so that we can share ratings.**  
   Acceptance criteria:   
   - Приглашение по ссылка на комнату.  
   - Группы приватные, доступ только по приглашению.

1. **As a user, I want to view my rating of a movie**  

1. **As a user, I want to view ratings in my group so that I can compare opinions.**  
   Acceptance criteria:  
   - Список фильмов с оценками от членов группы.  
   - Фильтр по фильмам или пользователям.
   - при добавлении фильма сделать опцию Обсуждение Тру / фалс. Если опция Тру, то у фильма есть Дата Обсуждения. До даты - оценки посмотреть нельзя. После - можно. Если изначально False - то оценки можно посмотреть. Но обязательно чтобы оценки были доступны по +1 кнопке, чтобы случайно не заспойлерить себе чужие оценки

1. **As a user, I want to see Statistics so that I can track activity.**  
   Acceptance criteria:  
   - Средний балл по пользователю/группе.
   - Простые графики (bar charts) с использованием JS.

Статистика
	По пользователю
		какие фильмы выбирал
		какие оценки ставил 
		на сколько средняя оценка пользователя отличается от средней оценки в Комнате 
	По фильму
		средняя оценка в Комнате 
	По комнате 
        сортировка фильмов по оценке

Фильм
	Метадата
		- дата добавления
		- кто выбрал фильм 
		- ссылка на Кинопоиск
		- средняя оценка в Комнате (динамически считается)

Комната
	- private / public. Если private, то зайти можно только по приглашению. public доступна в &Поиске. MVP - private
	- список участников
	- список фильмов с сортировкой (дата добавления(дефолт), оценки моя, оценка средняя)
	- текущий фильм на просмотр 


## 3. Нефункциональные требования

| Категория          | Требование                                                                 | Метрики/Критерии |
|--------------------|----------------------------------------------------------------------------|------------------|
| **Производительность** | Время отклика страниц не более 2 секунд при нагрузке до 100 одновременных пользователей. | Тестирование с JMeter; кэширование запросов к БД. |
| **Масштабируемость** | Поддержка роста до 1000 пользователей без значительной перестройки. | Использование Docker для контейнеризации; горизонтальное масштабирование backend. |
| **Безопасность**   | Защита от SQL-инъекций, XSS, CSRF; хранение паролей с хэшированием (bcrypt). | OWASP Top 10 compliance; HTTPS обязательен. |
| **Доступность**    | Поддержка браузеров Chrome, Firefox, Safari (последние версии); responsive дизайн. | WCAG 2.1 level A; мобильная адаптация. |
| **Надежность**     | Uptime 99%; автоматическое бэкап БД ежедневно. | Мониторинг с Sentry; обработка ошибок. |
| **Юзабилити**      | Интуитивный интерфейс; поддержка темной/светлой темы. | User testing; A/B тесты для UI. |

## 4. Архитектура

**High-level архитектура (текстовый диаграмма):**

```text
[Frontend (Browser)] <-> [API Endpoints (Django)]
                          |
                          v
[Backend Logic (Django Views/Models)] <-> [ORM (SQLAlchemy/Django ORM)]
                          |
                          v
[Database (PostgreSQL/MySQL)] 
```


- **Frontend:** HTML/CSS/JS с Jinja templates (для MVP; React для будущих улучшений). Запросы к backend через AJAX для динамики.
- **Backend:** Django как монолит для MVP. RESTful API для взаимодействия (если нужен мобильный клиент позже).
- **Database:** Реляционная БД с таблицами: Users (id, username, email, password_hash), Movies (id, title, year, genre), Ratings (id, user_id, movie_id, score), Groups (id, name), GroupMembers (group_id, user_id).
- **Компоненты:** 
  - Authentication: Django built-in auth.
  - Statistics: Вычисления в views, визуализация с Chart.js.

**ER-диаграмма (текстовая):**

```text
Users --(1:N)-- Ratings --(N:1)-- Movies
Groups --(1:N)-- GroupMembers --(N:1)-- Users
```


## 5. Технологический стек

- **Backend:** Python 3.14, FastAPI 0.x (последняя версия).
- **ORM:** SQLAlchemy (для работы с БД, включая async поддержку).
- **Database:** PostgreSQL (предпочтительно для продакшена; MySQL как альтернатива).
- **Frontend:** HTML5, CSS3, JavaScript (ES6+), Jinja2 для шаблонов, Bootstrap для стилей.
- **Дополнительно:** Celery для асинхронных задач (если нужны уведомления), Redis для кэша.
- **Deployment:** Docker, Nginx как reverse proxy, Uvicorn для ASGI.
- **Тестирование:** Pytest, Selenium.
- **Безопасность:** FastAPI dependencies для auth, JWT для токенов.

## 6. План разработки и тестирования

**Этапы разработки (Agile с спринтами по 2 недели):**

1. **Спринт 1: Планирование и setup (1 неделя).** Установка стека, создание репозитория, базовая структура FastAPI.
2. **Спринт 2: Аутентификация и пользователи (2 недели).** Разработка регистрации, логина, профилей.
3. **Спринт 3: Фильмы и оценки (2 недели).** Добавление фильмов, система оценок.
4. **Спринт 4: Группы и статистика (2 недели).** Группы, приглашения, базовая статистика.
5. **Спринт 5: Frontend polish и deploy (1 неделя).** UI улучшения, деплой на Heroku/VPS.

**Тестирование:**

- **Unit tests:** Для models и views (Pytest, coverage >80%).
- **Integration tests:** API endpoints.
- **E2E tests:** Selenium для UI.
- **Security testing:** Статический анализ (Bandit), manual pentest.
- **Performance testing:** Load testing с Locust.
- **Этапы:** Тестирование в конце каждого спринта; CI/CD с GitHub Actions.

**Минимальные системные требования:**  
- Server: 2 CPU, 4GB RAM, 20GB SSD.  
- Client: Современный браузер, интернет 1Mbps+.

**Возможные риски:**  
- Задержки из-за интеграций (риск: низкий, отложить).  
- Безопасность данных (mitigation: аудит кода).  
- Масштабируемость при росте (mitigation: мониторинг).  
- Зависимость от внешних библиотек (риск: обновления версий).

## 7. Приложения

**Глоссарий:**  
- **MVP:** Minimum Viable Product — минимально жизнеспособный продукт.  
- **User Story:** Формат описания требований: "As a [role], I want [feature] so that [benefit]".  
- **ORM:** Object-Relational Mapping — инструмент для работы с БД как с объектами.  
- **RESTful API:** Архитектура для веб-сервисов на основе HTTP.  

**Дополнительные приложения:** Нет (если нужны диаграммы — добавить в будущем).